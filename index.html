<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>UrbanBrief – Planning Reality Report Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --ub-primary: #1f4f7b;
      --ub-secondary: #f5f7fb;
      --ub-border: #dde2ed;
      --ub-text: #222222;
      --ub-muted: #6b7280;
      --ub-accent: #f97316;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--ub-secondary);
      color: var(--ub-text);
      line-height: 1.5;
    }

    a {
      color: var(--ub-primary);
    }

    .page {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 16px 48px;
    }

    header.main-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
      gap: 16px;
    }

    .logo-lockup {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-mark {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      border: 2px solid var(--ub-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: var(--ub-primary);
      background: white;
    }

    .logo-text h1 {
      margin: 0;
      font-size: 1.1rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--ub-primary);
    }

    .logo-text p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--ub-muted);
    }

    .tagline {
      font-size: 0.85rem;
      color: var(--ub-muted);
      text-align: right;
    }

    /* Panels */
    .panel {
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
      padding: 24px 20px 28px;
      margin-bottom: 24px;
      border: 1px solid var(--ub-border);
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      gap: 12px;
    }

    .panel-header h2 {
      margin: 0;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.75rem;
      padding: 3px 10px;
      border-radius: 999px;
      background: rgba(31, 79, 123, 0.05);
      color: var(--ub-primary);
    }

    .badge span {
      font-weight: 600;
      font-size: 0.8rem;
    }

    .panel-header p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--ub-muted);
    }

    /* Form layout */
    form {
      display: grid;
      gap: 18px;
    }

    .section {
      border-radius: 12px;
      border: 1px solid var(--ub-border);
      padding: 14px 14px 4px;
      background: #ffffff;
    }

    .section-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 8px;
    }

    .section-header h3 {
      margin: 0;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--ub-primary);
    }

    .section-header span {
      font-size: 0.8rem;
      color: var(--ub-muted);
    }

    .field-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px 16px;
      margin-bottom: 10px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .field label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #374151;
    }

    .field small {
      font-size: 0.75rem;
      color: var(--ub-muted);
    }

    input[type="text"],
    input[type="email"],
    input[type="url"],
    select,
    textarea {
      border-radius: 8px;
      border: 1px solid var(--ub-border);
      padding: 7px 9px;
      font-size: 0.9rem;
      font-family: inherit;
      background: #f9fafb;
      transition: border-color 0.15s, box-shadow 0.15s, background 0.15s;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: var(--ub-primary);
      box-shadow: 0 0 0 2px rgba(31, 79, 123, 0.15);
      background: white;
    }

    textarea {
      min-height: 70px;
      resize: vertical;
    }

    .inline-options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 16px;
      font-size: 0.85rem;
    }

    .inline-options label {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      cursor: pointer;
      font-weight: 500;
      color: #374151;
    }

    .inline-options input[type="checkbox"],
    .inline-options input[type="radio"] {
      accent-color: var(--ub-primary);
    }

    .hint {
      font-size: 0.8rem;
      color: var(--ub-muted);
      margin-top: 2px;
    }

    .subsection-title {
      font-size: 0.85rem;
      font-weight: 700;
      color: #111827;
      margin: 4px 0 2px;
    }

    .divider {
      border-top: 1px dashed var(--ub-border);
      margin: 8px 0 6px;
    }

    .actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 10px;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 8px 16px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.1s ease;
    }

    button.primary {
      background: var(--ub-primary);
      color: white;
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.25);
    }

    button.secondary {
      background: white;
      color: var(--ub-primary);
      border: 1px solid var(--ub-border);
    }

    button:hover {
      transform: translateY(-1px);
    }

    button:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .note {
      font-size: 0.8rem;
      color: var(--ub-muted);
      margin-top: 6px;
    }

    /* Report styles */
    #report-panel {
      display: none;
    }

    #report {
      max-width: 900px;
      margin: 0 auto;
      padding: 32px 30px 36px;
      background: #ffffff;
      border-radius: 16px;
      border: 1px solid var(--ub-border);
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
    }

    .report-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
      border-bottom: 2px solid var(--ub-border);
      padding-bottom: 14px;
      margin-bottom: 14px;
    }

    .report-title-block h1 {
      margin: 0;
      font-size: 1.4rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--ub-primary);
    }

    .report-title-block p {
      margin: 4px 0 0;
      font-size: 0.85rem;
      color: var(--ub-muted);
    }

    .report-meta {
      text-align: right;
      font-size: 0.8rem;
      color: var(--ub-muted);
    }

    .report-meta div {
      margin-bottom: 2px;
    }

    .report-logo {
      width: 70px;
      height: 70px;
      border-radius: 16px;
      border: 2px solid var(--ub-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: var(--ub-primary);
      font-size: 1.3rem;
    }

    .report-section {
      margin-bottom: 14px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.4);
    }

    .report-section:last-of-type {
      border-bottom: none;
      margin-bottom: 0;
    }

    .report-section h2 {
      margin: 0 0 4px;
      font-size: 1rem;
      color: #111827;
      border-left: 4px solid var(--ub-primary);
      padding-left: 10px;
    }

    .report-section h3 {
      margin: 6px 0 2px;
      font-size: 0.9rem;
      color: #111827;
    }

    .report-section p {
      margin: 2px 0 4px;
      font-size: 0.86rem;
    }

    .report-section ul {
      margin: 0 0 4px 18px;
      padding: 0;
      font-size: 0.86rem;
    }

    .label {
      font-weight: 600;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      font-size: 0.75rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--ub-border);
      background: #f9fafb;
    }

    .pill.positive {
      border-color: rgba(34, 197, 94, 0.4);
    }

    .pill.negative {
      border-color: rgba(248, 113, 113, 0.6);
    }

    .pill.negative::before {
      content: "!";
      margin-right: 4px;
      font-weight: 700;
      color: #b91c1c;
    }

    .accent-box {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      background: #f9fafb;
      font-size: 0.84rem;
    }

    .accent-box strong {
      font-weight: 600;
    }

    .report-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .report-actions .note {
      margin: 0;
    }

    .disclaimer {
      font-size: 0.78rem;
      color: var(--ub-muted);
      margin-top: 6px;
      border-top: 1px solid var(--ub-border);
      padding-top: 6px;
    }

    .small-heading {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--ub-muted);
      margin: 6px 0 2px;
    }

    .no-print {
      /* Hidden in print mode */
    }

    @media (max-width: 720px) {
      header.main-header {
        flex-direction: column;
        align-items: flex-start;
      }
      .tagline {
        text-align: left;
      }
      .report-header {
        flex-direction: column;
        align-items: flex-start;
      }
      .report-meta {
        text-align: left;
      }
    }

    @media print {
      body {
        background: white;
      }

      .page {
        padding: 0;
        max-width: none;
      }

      #input-panel {
        display: none !important;
      }

      #report-panel {
        display: block !important;
      }

      #report {
        box-shadow: none;
        border-radius: 0;
        max-width: none;
        margin: 0;
        border: none;
        padding: 16mm 14mm 18mm;
        page-break-after: avoid;
      }

      .no-print {
        display: none !important;
      }

      .report-section {
        page-break-inside: avoid;
      }
    }
  </style>
</head>
<body>
<div class="page">
  <header class="main-header">
    <div class="logo-lockup">
      <div class="logo-mark">UB</div>
      <div class="logo-text">
        <h1>UrbanBrief</h1>
        <p>Planning Reality Report – Internal Form</p>
      </div>
    </div>
    <div class="tagline">
      <div>For internal UrbanBrief use only</div>
      <div>Complete accurately using the LPA website and policy documents.</div>
    </div>
  </header>

  <!-- INPUT PANEL -->
  <div id="input-panel" class="panel">
    <div class="panel-header">
      <div>
        <h2>
          Planning Reality Report – Input Checklist
        </h2>
        <p>Junior: work through each section. Use council website, policy PDFs and Google Maps / Street View.</p>
      </div>
      <div class="badge">
        <span>Step 1</span>
        Form Inputs
      </div>
    </div>

    <form id="prrForm">
      <!-- CLIENT & SITE -->
      <div class="section">
        <div class="section-header">
          <h3>Client & Site</h3>
          <span>Basic details for the report cover.</span>
        </div>
        <div class="field-grid">
          <div class="field">
            <label for="client_name">Client name</label>
            <input type="text" id="client_name" name="client_name" placeholder="e.g. Smith Developments Ltd">
          </div>
          <div class="field">
            <label for="client_contact_email">Client email (optional)</label>
            <input type="email" id="client_contact_email" name="client_contact_email">
          </div>
          <div class="field">
            <label for="site_address">Site address</label>
            <input type="text" id="site_address" name="site_address" required>
          </div>
          <div class="field">
            <label for="site_postcode">Postcode</label>
            <input type="text" id="site_postcode" name="site_postcode" required>
          </div>
          <div class="field">
            <label for="council_name">Local planning authority</label>
            <input type="text" id="council_name" name="council_name" placeholder="e.g. London Borough of Camden" required>
          </div>
          <div class="field">
            <label for="existing_use_class">Existing use class</label>
            <input type="text" id="existing_use_class" name="existing_use_class" placeholder="e.g. C3 dwellinghouse">
            <small class="hint">Look up on council records / planning history where available.</small>
          </div>
          <div class="field">
            <label for="proposal_summary">Proposal summary (plain English)</label>
            <textarea id="proposal_summary" name="proposal_summary" placeholder="e.g. Single-storey rear extension to a two-storey dwelling."></textarea>
          </div>
        </div>
      </div>

      <!-- SITE BASICS -->
      <div class="section">
        <div class="section-header">
          <h3>A. Site Basics</h3>
          <span>High-level classification of the site and proposal.</span>
        </div>
        <div class="field-grid">
          <div class="field">
            <label for="site_type">Site type</label>
            <select id="site_type" name="site_type">
              <option value="">Select…</option>
              <option value="res_single">Residential – single dwelling</option>
              <option value="res_flats">Residential – flats / HMO</option>
              <option value="commercial">Commercial / retail unit</option>
              <option value="mixed_use">Mixed-use</option>
              <option value="vacant_land">Vacant land</option>
              <option value="agricultural">Agricultural land / countryside</option>
              <option value="industrial">Industrial site</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="field">
            <label for="proposal_type">Proposal type</label>
            <select id="proposal_type" name="proposal_type">
              <option value="">Select…</option>
              <option value="single_storey_rear_extension">House extension – single-storey</option>
              <option value="two_storey_rear_extension">House extension – two-storey</option>
              <option value="loft_conversion">Loft conversion / dormer</option>
              <option value="outbuilding">Outbuilding / garden room / annex</option>
              <option value="change_of_use">Change of use</option>
              <option value="new_dwelling">New dwelling(s)</option>
              <option value="commercial_alterations">Commercial alterations</option>
              <option value="advertisement">Advertisement / signage</option>
              <option value="demolition">Demolition</option>
              <option value="prior_larger_home_ext">Prior Approval – Larger home extension</option>
              <option value="prior_class_ma">Prior Approval – Class MA (commercial → res)</option>
              <option value="prior_class_q">Prior Approval – Class Q (agricultural → res)</option>
              <option value="prior_other">Prior Approval – other</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="field">
            <label for="previous_applications">Previous applications on this site?</label>
            <select id="previous_applications" name="previous_applications">
              <option value="">Select…</option>
              <option value="none">No</option>
              <option value="approved">Yes – approved</option>
              <option value="refused">Yes – refused</option>
              <option value="withdrawn">Yes – withdrawn</option>
            </select>
            <small class="hint">Details entered in the Planning History section below.</small>
          </div>
        </div>

        <div class="subsection-title">Designations & location</div>
        <div class="field">
          <label>Is the site within any of the following?</label>
          <div class="inline-options">
            <label><input type="checkbox" name="designations" value="conservation_area"> Conservation area</label>
            <label><input type="checkbox" name="designations" value="green_belt"> Green Belt</label>
            <label><input type="checkbox" name="designations" value="aonb"> AONB</label>
            <label><input type="checkbox" name="designations" value="national_park"> National Park</label>
            <label><input type="checkbox" name="designations" value="world_heritage_site"> World Heritage Site</label>
            <label><input type="checkbox" name="designations" value="article_4"> Article 4 Direction area</label>
            <label><input type="checkbox" name="designations" value="flood_zone_1"> Flood Zone 1</label>
            <label><input type="checkbox" name="designations" value="flood_zone_2"> Flood Zone 2</label>
            <label><input type="checkbox" name="designations" value="flood_zone_3"> Flood Zone 3</label>
            <label><input type="checkbox" name="designations" value="sssi"> SSSI / SAC</label>
            <label><input type="checkbox" name="designations" value="listed_building"> Listed building</label>
            <label><input type="checkbox" name="designations" value="locally_listed"> Locally listed</label>
            <label><input type="checkbox" name="designations" value="none"> None</label>
          </div>
        </div>
      </div>

      <!-- CONTEXT & CONSTRAINTS -->
      <div class="section">
        <div class="section-header">
          <h3>B. Site Context & Constraints</h3>
          <span>Summarise key risks and sensitivities.</span>
        </div>

        <div class="field">
          <label>Known constraints</label>
          <div class="inline-options">
            <label><input type="checkbox" name="constraints" value="tpo"> Protected trees (TPO)</label>
            <label><input type="checkbox" name="constraints" value="hedgerows"> Important hedgerows</label>
            <label><input type="checkbox" name="constraints" value="right_of_way"> Right of way across site</label>
            <label><input type="checkbox" name="constraints" value="contaminated"> Contaminated land</label>
            <label><input type="checkbox" name="constraints" value="noise"> Noise (road / rail / industrial)</label>
            <label><input type="checkbox" name="constraints" value="aqma"> Air Quality Management Area</label>
            <label><input type="checkbox" name="constraints" value="archaeology"> Archaeological interest</label>
            <label><input type="checkbox" name="constraints" value="heritage_sightlines"> Heritage sightline issues</label>
            <label><input type="checkbox" name="constraints" value="unknown"> Unknown</label>
          </div>
        </div>

        <div class="field-grid">
          <div class="field">
            <label for="visibility_public">Is the proposal visible from public viewpoints?</label>
            <select id="visibility_public" name="visibility_public">
              <option value="">Select…</option>
              <option value="prominent">Yes – prominently</option>
              <option value="partial">Yes – partially</option>
              <option value="no">No</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>

          <div class="field">
            <label for="privacy_impact">Does the proposal affect neighbours’ privacy?</label>
            <select id="privacy_impact" name="privacy_impact">
              <option value="">Select…</option>
              <option value="upper_overlooking">Yes – from new upper-floor windows/balcony</option>
              <option value="ground_overlooking">Yes – from ground floor</option>
              <option value="garden_relationship">Yes – garden relationships affected</option>
              <option value="no">No impact</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>

          <div class="field">
            <label for="daylight_impact">Does the proposal affect neighbours’ daylight/sunlight?</label>
            <select id="daylight_impact" name="daylight_impact">
              <option value="">Select…</option>
              <option value="loss_daylight">Yes – likely loss of daylight</option>
              <option value="overshadowing">Yes – likely overshadowing</option>
              <option value="no">No</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
        </div>
      </div>

      <!-- DESIGN & LAYOUT -->
      <div class="section">
        <div class="section-header">
          <h3>C. Design & Layout</h3>
          <span>Basic design parameters and neighbour relationships.</span>
        </div>

        <div class="field-grid">
          <div class="field">
            <label for="balcony_presence">Is there a proposed balcony / terrace?</label>
            <select id="balcony_presence" name="balcony_presence">
              <option value="">Select…</option>
              <option value="none">No</option>
              <option value="ground">Yes – at ground floor</option>
              <option value="upper">Yes – above ground floor</option>
            </select>
          </div>

          <div class="field">
            <label for="balcony_screening">If yes, is it screened?</label>
            <select id="balcony_screening" name="balcony_screening">
              <option value="">Select…</option>
              <option value="na">Not applicable</option>
              <option value="both_sides">Yes – both sides</option>
              <option value="one_side">Yes – one side</option>
              <option value="none">No screening</option>
            </select>
          </div>

          <div class="field">
            <label for="proposal_height">Approximate maximum height of proposal (m)</label>
            <select id="proposal_height" name="proposal_height">
              <option value="">Select…</option>
              <option value="under_2_5">&lt; 2.5m</option>
              <option value="2_5_3">2.5–3m</option>
              <option value="3_4">3–4m</option>
              <option value="4_5">4–5m</option>
              <option value="over_5">&gt; 5m</option>
            </select>
          </div>

          <div class="field">
            <label for="rear_projection">Does the extension project beyond neighbours?</label>
            <select id="rear_projection" name="rear_projection">
              <option value="">Select…</option>
              <option value="none">No</option>
              <option value="slight">Slightly</option>
              <option value="moderate">Moderately</option>
              <option value="significant">Significantly</option>
            </select>
          </div>

          <div class="field">
            <label for="materials">Proposed materials</label>
            <select id="materials" name="materials">
              <option value="">Select…</option>
              <option value="matching">Matching existing</option>
              <option value="similar">Similar to existing</option>
              <option value="contrasting">Contrasting</option>
              <option value="unknown">Unknown</option>
            </select>
          </div>
        </div>
      </div>

      <!-- POLICY-SPECIFIC -->
      <div class="section">
        <div class="section-header">
          <h3>D. Policy & Guidance Findings</h3>
          <span>Use council Local Plan / SPD documents.</span>
        </div>

        <div class="field-grid">
          <div class="field">
            <label for="has_extension_spd">Does the council have a Residential Extensions SPD?</label>
            <select id="has_extension_spd" name="has_extension_spd">
              <option value="">Select…</option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
          <div class="field">
            <label for="spd_compliance">Does the proposal comply with the SPD?</label>
            <select id="spd_compliance" name="spd_compliance">
              <option value="">Select…</option>
              <option value="fully">Fully compliant</option>
              <option value="partial">Partially compliant</option>
              <option value="non_compliant">Non-compliant</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
          <div class="field">
            <label for="parking_compliance">Parking standards (Local Plan)</label>
            <select id="parking_compliance" name="parking_compliance">
              <option value="">Select…</option>
              <option value="meets">Meets / exceeds requirement</option>
              <option value="shortfall">Shortfall</option>
              <option value="not_applicable">Not applicable</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
          <div class="field">
            <label for="housing_mix_compliance">Housing mix / size policy (for new dwellings)</label>
            <select id="housing_mix_compliance" name="housing_mix_compliance">
              <option value="">Select…</option>
              <option value="compliant">Compliant</option>
              <option value="partial">Partially compliant</option>
              <option value="non_compliant">Non-compliant</option>
              <option value="not_applicable">Not applicable</option>
            </select>
          </div>
        </div>

        <div class="subsection-title">NPPF-level judgement</div>
        <div class="field-grid">
          <div class="field">
            <label for="nppf_sustainable">Is the site in a sustainable location?</label>
            <select id="nppf_sustainable" name="nppf_sustainable">
              <option value="">Select…</option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
              <option value="partial">Partially</option>
            </select>
          </div>
          <div class="field">
            <label for="nppf_characterscore">Character impact (NPPF)</label>
            <select id="nppf_characterscore" name="nppf_characterscore">
              <option value="">Select…</option>
              <option value="enhancement">Enhancement</option>
              <option value="low">Low impact</option>
              <option value="moderate">Moderate impact</option>
              <option value="high">High impact</option>
            </select>
          </div>
          <div class="field">
            <label for="nppf_heritage">Heritage impact (if applicable)</label>
            <select id="nppf_heritage" name="nppf_heritage">
              <option value="">Select…</option>
              <option value="no_harm">No harm</option>
              <option value="less_than_substantial">Less than substantial harm</option>
              <option value="substantial_harm">Substantial harm</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
        </div>
      </div>

      <!-- POLICY EVIDENCE BLOCKS -->
      <div class="section">
        <div class="section-header">
          <h3>D2. Detailed Policy Extracts</h3>
          <span>Copy exact text from council documents.</span>
        </div>

        <div class="note">Complete at least one block. Use additional blocks if more policies are directly relevant.</div>

        <!-- Policy 1 -->
        <div class="subsection-title">Policy 1</div>
        <div class="field-grid">
          <div class="field">
            <label for="policy1_authority">Authority / council</label>
            <input type="text" id="policy1_authority" name="policy1_authority" placeholder="e.g. London Borough of Camden">
          </div>
          <div class="field">
            <label for="policy1_doc_title">Document title</label>
            <input type="text" id="policy1_doc_title" name="policy1_doc_title" placeholder="e.g. Camden Local Plan 2017">
          </div>
          <div class="field">
            <label for="policy1_ref">Policy reference</label>
            <input type="text" id="policy1_ref" name="policy1_ref" placeholder="e.g. Policy D1">
          </div>
          <div class="field">
            <label for="policy1_title">Policy title</label>
            <input type="text" id="policy1_title" name="policy1_title" placeholder="e.g. Design">
          </div>
        </div>
        <div class="field-grid">
          <div class="field">
            <label for="policy1_quote">Direct policy quote</label>
            <textarea id="policy1_quote" name="policy1_quote" placeholder="Copy and paste the relevant lines from the policy document."></textarea>
          </div>
          <div class="field">
            <label for="policy1_interp">Junior interpretation / comment</label>
            <textarea id="policy1_interp" name="policy1_interp" placeholder="Explain briefly how the proposal does or does not comply with this policy."></textarea>
          </div>
        </div>
        <div class="field">
          <label for="policy1_url">Source URL</label>
          <input type="url" id="policy1_url" name="policy1_url" placeholder="Link to the online policy document or PDF.">
        </div>

        <div class="divider"></div>

        <!-- Policy 2 -->
        <div class="subsection-title">Policy 2 (optional)</div>
        <div class="field-grid">
          <div class="field">
            <label for="policy2_authority">Authority / council</label>
            <input type="text" id="policy2_authority" name="policy2_authority">
          </div>
          <div class="field">
            <label for="policy2_doc_title">Document title</label>
            <input type="text" id="policy2_doc_title" name="policy2_doc_title">
          </div>
          <div class="field">
            <label for="policy2_ref">Policy reference</label>
            <input type="text" id="policy2_ref" name="policy2_ref">
          </div>
          <div class="field">
            <label for="policy2_title">Policy title</label>
            <input type="text" id="policy2_title" name="policy2_title">
          </div>
        </div>
        <div class="field-grid">
          <div class="field">
            <label for="policy2_quote">Direct policy quote</label>
            <textarea id="policy2_quote" name="policy2_quote"></textarea>
          </div>
          <div class="field">
            <label for="policy2_interp">Junior interpretation / comment</label>
            <textarea id="policy2_interp" name="policy2_interp"></textarea>
          </div>
        </div>
        <div class="field">
          <label for="policy2_url">Source URL</label>
          <input type="url" id="policy2_url" name="policy2_url">
        </div>
      </div>

      <!-- TECHNICAL MATTERS -->
      <div class="section">
        <div class="section-header">
          <h3>E. Technical Matters</h3>
          <span>Drainage, highways, ecology and trees.</span>
        </div>

        <div class="field-grid">
          <div class="field">
            <label for="drainage_known">Existing drainage known?</label>
            <select id="drainage_known" name="drainage_known">
              <option value="">Select…</option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
          <div class="field">
            <label for="suds_required">Is SuDS likely to be required?</label>
            <select id="suds_required" name="suds_required">
              <option value="">Select…</option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
          <div class="field">
            <label for="highways_safety">Highways / access issues?</label>
            <select id="highways_safety" name="highways_safety">
              <option value="">Select…</option>
              <option value="acceptable">Visibility / access acceptable</option>
              <option value="minor_issues">Minor concerns</option>
              <option value="major_issues">Likely major issues</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
          <div class="field">
            <label for="ecology_risk">Any ecology risk (bats, habitats etc.)?</label>
            <select id="ecology_risk" name="ecology_risk">
              <option value="">Select…</option>
              <option value="none">No known risk</option>
              <option value="possible">Possible, may need survey</option>
              <option value="likely">Likely, survey expected</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
          <div class="field">
            <label for="trees_impact">Trees affected?</label>
            <select id="trees_impact" name="trees_impact">
              <option value="">Select…</option>
              <option value="none">No</option>
              <option value="tpo">Yes – TPO trees</option>
              <option value="non_tpo">Yes – non-TPO trees</option>
              <option value="unsure">Unsure</option>
            </select>
          </div>
        </div>
      </div>

      <!-- PLANNING HISTORY & PRECEDENT -->
      <div class="section">
        <div class="section-header">
          <h3>Planning History & Precedent</h3>
          <span>Site history plus nearby examples.</span>
        </div>

        <div class="subsection-title">Site Planning History – most relevant application</div>
        <div class="field-grid">
          <div class="field">
            <label for="hist1_ref">Application reference</label>
            <input type="text" id="hist1_ref" name="hist1_ref">
          </div>
          <div class="field">
            <label for="hist1_desc">Description</label>
            <input type="text" id="hist1_desc" name="hist1_desc">
          </div>
          <div class="field">
            <label for="hist1_decision">Decision</label>
            <select id="hist1_decision" name="hist1_decision">
              <option value="">Select…</option>
              <option value="approved">Approved</option>
              <option value="refused">Refused</option>
              <option value="withdrawn">Withdrawn</option>
              <option value="pending">Pending</option>
            </select>
          </div>
          <div class="field">
            <label for="hist1_date">Decision date (text)</label>
            <input type="text" id="hist1_date" name="hist1_date" placeholder="e.g. 12 March 2023">
          </div>
        </div>
        <div class="field-grid">
          <div class="field">
            <label for="hist1_officer">Key officer comments (copy)</label>
            <textarea id="hist1_officer" name="hist1_officer"></textarea>
          </div>
          <div class="field">
            <label for="hist1_relevance">Why is this relevant?</label>
            <textarea id="hist1_relevance" name="hist1_relevance" placeholder="Explain what this decision tells us about how the LPA views similar proposals."></textarea>
          </div>
        </div>

        <div class="divider"></div>

        <div class="subsection-title">Nearby precedent (optional)</div>
        <div class="field-grid">
          <div class="field">
            <label for="prec1_address">Nearby address</label>
            <input type="text" id="prec1_address" name="prec1_address">
          </div>
          <div class="field">
            <label for="prec1_ref">Council reference</label>
            <input type="text" id="prec1_ref" name="prec1_ref">
          </div>
          <div class="field">
            <label for="prec1_desc">Description of development</label>
            <input type="text" id="prec1_desc" name="prec1_desc">
          </div>
          <div class="field">
            <label for="prec1_decision">Decision result</label>
            <select id="prec1_decision" name="prec1_decision">
              <option value="">Select…</option>
              <option value="approved">Approved</option>
              <option value="refused">Refused</option>
            </select>
          </div>
        </div>
        <div class="field">
          <label for="prec1_relevance">Why is this precedent relevant?</label>
          <textarea id="prec1_relevance" name="prec1_relevance"></textarea>
        </div>
      </div>

      <!-- MAPS -->
      <div class="section">
        <div class="section-header">
          <h3>Maps & Street View</h3>
          <span>Paste links from Google Maps.</span>
        </div>
        <div class="field-grid">
          <div class="field">
            <label for="maps_location_url">Google Maps URL</label>
            <input type="url" id="maps_location_url" name="maps_location_url" placeholder="https://maps.google.com/...">
            <small class="hint">Open the red-pin location and copy the URL from the address bar.</small>
          </div>
          <div class="field">
            <label for="maps_streetview_url">Street View URL</label>
            <input type="url" id="maps_streetview_url" name="maps_streetview_url" placeholder="https://www.google.com/maps/@...">
            <small class="hint">Choose the clearest street view of the site.</small>
          </div>
        </div>
      </div>

      <!-- SUMMARY & BALANCE -->
      <div class="section">
        <div class="section-header">
          <h3>Planning Balance & Risk</h3>
          <span>Overall risk level and key issues.</span>
        </div>

        <div class="field-grid">
          <div class="field">
            <label for="likelihood">Overall likelihood of approval (your view)</label>
            <select id="likelihood" name="likelihood">
              <option value="">Select…</option>
              <option value="high">High</option>
              <option value="moderate">Moderate</option>
              <option value="low">Low</option>
              <option value="very_low">Very low</option>
            </select>
          </div>
        </div>

        <div class="subsection-title">Key benefits (tick all that apply)</div>
        <div class="field">
          <div class="inline-options">
            <label><input type="checkbox" name="benefits" value="better_accommodation"> Better quality accommodation</label>
            <label><input type="checkbox" name="benefits" value="visual_improvement"> Visual improvement</label>
            <label><input type="checkbox" name="benefits" value="energy_efficiency"> Energy efficiency improvements</label>
            <label><input type="checkbox" name="benefits" value="more_space"> Additional internal floorspace</label>
            <label><input type="checkbox" name="benefits" value="better_layout"> Improved layout / accessibility</label>
            <label><input type="checkbox" name="benefits" value="policy_support"> Strong policy support</label>
          </div>
        </div>

        <div class="subsection-title">Key risks / harms (tick all that apply)</div>
        <div class="field">
          <div class="inline-options">
            <label><input type="checkbox" name="risks" value="overlooking"> Overlooking / privacy</label>
            <label><input type="checkbox" name="risks" value="overshadowing"> Overshadowing / daylight</label>
            <label><input type="checkbox" name="risks" value="bulk_scale"> Bulk / scale / massing</label>
            <label><input type="checkbox" name="risks" value="heritage_harm"> Heritage impact</label>
            <label><input type="checkbox" name="risks" value="green_belt_conflict"> Green Belt issues</label>
            <label><input type="checkbox" name="risks" value="parking_highways"> Parking / highways</label>
            <label><input type="checkbox" name="risks" value="design_non_compliance"> Design non-compliance</label>
            <label><input type="checkbox" name="risks" value="drainage_ecology"> Drainage / ecology</label>
            <label><input type="checkbox" name="risks" value="neighbour_objections"> Neighbour objections likely</label>
          </div>
        </div>

        <div class="field">
          <label for="junior_balance">Junior’s draft planning balance (short summary)</label>
          <textarea id="junior_balance" name="junior_balance" placeholder="In 3–5 sentences, explain the key benefits, key risks, and your overall judgement."></textarea>
        </div>
      </div>

      <div class="actions">
        <button type="submit" class="primary">
          Generate Planning Reality Report
        </button>
      </div>
      <p class="note">Once generated, use “Print / Save as PDF” on the report screen. Reports are indicative and for UrbanBrief use only.</p>
    </form>
  </div>

  <!-- REPORT PANEL -->
  <div id="report-panel" class="panel">
    <div class="panel-header no-print">
      <div>
        <h2>Planning Reality Report – Preview</h2>
        <p>Review quickly before saving as PDF. Use this version for issuing to clients.</p>
      </div>
      <div class="badge">
        <span>Step 2</span>
        Review & Export
      </div>
    </div>

    <div class="report-actions no-print">
      <div class="actions">
        <button type="button" class="secondary" id="backToForm">Back to form</button>
        <button type="button" class="primary" id="printReport">Print / Save as PDF</button>
      </div>
      <p class="note">Use “Save as PDF” in the print dialog for a client-ready document.</p>
    </div>

    <div id="report">
      <div class="report-header">
        <div class="report-title-block">
          <h1>Planning Reality Report</h1>
          <p><span id="r_council_name"></span> – <span id="r_site_address"></span></p>
        </div>
        <div class="report-meta">
          <div><strong>Prepared by:</strong> UrbanBrief</div>
          <div><strong>Client:</strong> <span id="r_client_name"></span></div>
          <div><strong>Use:</strong> Internal planning appraisal</div>
        </div>
        <div class="report-logo">
          UB
        </div>
      </div>

      <div class="report-section">
        <h2>1. Site & Proposal</h2>
        <p><span class="label">Site address:</span> <span id="r_site_address_2"></span>, <span id="r_site_postcode"></span></p>
        <p><span class="label">Local planning authority:</span> <span id="r_council_name_2"></span></p>
        <p><span class="label">Existing use class:</span> <span id="r_existing_use_class"></span></p>
        <p><span class="label">Site type:</span> <span id="r_site_type"></span></p>
        <p><span class="label">Proposal:</span> <span id="r_proposal_type"></span></p>
        <p><span class="label">Proposal summary:</span> <span id="r_proposal_summary"></span></p>
      </div>

      <div class="report-section">
        <h2>2. Designations, Context & Constraints</h2>
        <h3>2.1 Policy designations</h3>
        <p><span class="label">Site designations:</span></p>
        <div class="pill-row" id="r_designations"></div>

        <h3>2.2 Local constraints</h3>
        <p><span class="label">Known constraints:</span></p>
        <div class="pill-row" id="r_constraints"></div>

        <h3>2.3 Visibility & neighbourhood impact</h3>
        <p><span class="label">Visibility from public realm:</span> <span id="r_visibility_public"></span></p>
        <p><span class="label">Privacy impact:</span> <span id="r_privacy_impact"></span></p>
        <p><span class="label">Daylight / sunlight impact:</span> <span id="r_daylight_impact"></span></p>
      </div>

      <div class="report-section">
        <h2>3. Design & Neighbour Relationships</h2>
        <p><span class="label">Balcony / terrace:</span> <span id="r_balcony"></span></p>
        <p><span class="label">Balcony screening:</span> <span id="r_balcony_screening"></span></p>
        <p><span class="label">Approximate maximum height:</span> <span id="r_height"></span></p>
        <p><span class="label">Rear projection beyond neighbours:</span> <span id="r_rear_projection"></span></p>
        <p><span class="label">Materials:</span> <span id="r_materials"></span></p>
      </div>

      <div class="report-section">
        <h2>4. Policy Context & Assessment</h2>

        <h3>4.1 Local and national policy overview</h3>
        <p><span class="label">Residential extensions SPD present:</span> <span id="r_has_spd"></span></p>
        <p><span class="label">SPD compliance:</span> <span id="r_spd_compliance"></span></p>
        <p><span class="label">Parking standards:</span> <span id="r_parking_compliance"></span></p>
        <p><span class="label">Housing mix policy (if relevant):</span> <span id="r_housing_mix_compliance"></span></p>

        <div class="accent-box">
          <strong>NPPF perspective.</strong>
          <div>Sustainability of location: <span id="r_nppf_sustainable"></span>.</div>
          <div>Impact on character and appearance: <span id="r_nppf_character"></span>.</div>
          <div>Heritage impact (where applicable): <span id="r_nppf_heritage"></span>.</div>
        </div>

        <h3>4.2 Detailed policy extracts</h3>

        <div id="r_policy1_block" style="margin-top:6px;">
          <div class="small-heading">Policy 1</div>
          <p><span class="label">Document:</span> <span id="r_policy1_doc"></span></p>
          <p><span class="label">Policy:</span> <span id="r_policy1_ref"></span> – <span id="r_policy1_title"></span></p>
          <p><span class="label">Quote:</span> <em id="r_policy1_quote"></em></p>
          <p><span class="label">Comment:</span> <span id="r_policy1_interp"></span></p>
        </div>

        <div id="r_policy2_block" style="margin-top:10px; display:none;">
          <div class="small-heading">Policy 2</div>
          <p><span class="label">Document:</span> <span id="r_policy2_doc"></span></p>
          <p><span class="label">Policy:</span> <span id="r_policy2_ref"></span> – <span id="r_policy2_title"></span></p>
          <p><span class="label">Quote:</span> <em id="r_policy2_quote"></em></p>
          <p><span class="label">Comment:</span> <span id="r_policy2_interp"></span></p>
        </div>
      </div>

      <div class="report-section">
        <h2>5. Technical Considerations</h2>
        <p><span class="label">Drainage information available:</span> <span id="r_drainage_known"></span></p>
        <p><span class="label">SuDS likely to be required:</span> <span id="r_suds_required"></span></p>
        <p><span class="label">Highways / access:</span> <span id="r_highways_safety"></span></p>
        <p><span class="label">Ecology risks:</span> <span id="r_ecology_risk"></span></p>
        <p><span class="label">Trees impact:</span> <span id="r_trees_impact"></span></p>
      </div>

      <div class="report-section">
        <h2>6. Planning History & Precedent</h2>

        <h3>6.1 Site planning history</h3>
        <p><span class="label">Most relevant application:</span> <span id="r_hist1_ref"></span></p>
        <p><span class="label">Description:</span> <span id="r_hist1_desc"></span></p>
        <p><span class="label">Decision:</span> <span id="r_hist1_decision"></span> <span id="r_hist1_date"></span></p>
        <p><span class="label">Officer comment (summary):</span> <span id="r_hist1_officer"></span></p>
        <p><span class="label">Relevance to this proposal:</span> <span id="r_hist1_relevance"></span></p>

        <h3>6.2 Nearby precedent</h3>
        <p><span class="label">Address:</span> <span id="r_prec1_address"></span></p>
        <p><span class="label">Reference:</span> <span id="r_prec1_ref"></span></p>
        <p><span class="label">Description:</span> <span id="r_prec1_desc"></span></p>
        <p><span class="label">Decision:</span> <span id="r_prec1_decision"></span></p>
        <p><span class="label">Relevance:</span> <span id="r_prec1_relevance"></span></p>
      </div>

      <div class="report-section">
        <h2>7. Location & Mapping</h2>
        <p>This report has been informed by publicly available mapping and imagery.</p>
        <p><span class="label">Google Maps location:</span> <span id="r_maps_location_url"></span></p>
        <p><span class="label">Street View:</span> <span id="r_maps_streetview_url"></span></p>
        <p class="hint">Static images or embeds can be added in future iterations using these URLs.</p>
      </div>

      <div class="report-section">
        <h2>8. Planning Balance & Indicative Conclusion</h2>
        <p><span class="label">Overall likelihood of approval (internal assessment):</span> <span id="r_likelihood"></span></p>

        <h3>8.1 Key benefits</h3>
        <div class="pill-row" id="r_benefits"></div>

        <h3>8.2 Key risks</h3>
        <div class="pill-row" id="r_risks"></div>

        <h3>8.3 Narrative balance</h3>
        <p id="r_junior_balance"></p>

        <div class="accent-box">
          <strong>UrbanBrief internal view (summary).</strong>
          <p>
            On the basis of the information available at the time of writing, this proposal is considered to have an
            overall <span id="r_likelihood_inline"></span> prospect of gaining planning permission. The planning balance
            will depend on how the LPA weighs the identified benefits and harms, particularly in relation to local design
            guidance, character, amenity and technical matters.
          </p>
        </div>
      </div>

      <div class="disclaimer">
        <strong>Disclaimer.</strong> This Planning Reality Report has been prepared by UrbanBrief to provide an indicative,
        policy-led overview of the planning position for the identified site. It is based solely on the information
        provided and publicly available sources at the time of preparation. It does not constitute formal planning advice,
        a statutory planning statement or a guarantee of planning outcomes. Local planning authorities retain full
        discretion in determining applications and material circumstances may change over time. Clients should seek
        project-specific professional advice before committing to any course of action or financial expenditure.
      </div>
    </div>
  </div>
</div>

<script>
  const form = document.getElementById('prrForm');
  const inputPanel = document.getElementById('input-panel');
  const reportPanel = document.getElementById('report-panel');
  const backToFormBtn = document.getElementById('backToForm');
  const printBtn = document.getElementById('printReport');

  function getCheckedValues(name) {
    return Array.from(document.querySelectorAll('input[name="' + name + '"]:checked')).map(i => i.value);
  }

  function mapSelect(id) {
    const el = document.getElementById(id);
    if (!el) return '';
    const opt = el.options[el.selectedIndex];
    return opt && opt.text ? opt.text : '';
  }

  function textVal(id) {
    const el = document.getElementById(id);
    return el && el.value ? el.value.trim() : '';
  }

  function fillText(id, value) {
    const el = document.getElementById(id);
    if (el) {
      el.textContent = value || '';
    }
  }

  function buildPills(containerId, values, map) {
    const container = document.getElementById(containerId);
    if (!container) return;
    container.innerHTML = '';
    if (!values || values.length === 0) {
      const span = document.createElement('span');
      span.textContent = 'None recorded.';
      span.style.fontSize = '0.82rem';
      span.style.color = '#6b7280';
      container.appendChild(span);
      return;
    }
    values.forEach(v => {
      const pill = document.createElement('div');
      pill.className = 'pill ' + (map.type === 'risks' ? 'negative' : '');
      pill.textContent = (map.labels && map.labels[v]) || v;
      container.appendChild(pill);
    });
  }

  const labelMaps = {
    designations: {
      conservation_area: 'Conservation area',
      green_belt: 'Green Belt',
      aonb: 'Area of Outstanding Natural Beauty',
      national_park: 'National Park',
      world_heritage_site: 'World Heritage Site',
      article_4: 'Article 4 Direction',
      flood_zone_1: 'Flood Zone 1',
      flood_zone_2: 'Flood Zone 2',
      flood_zone_3: 'Flood Zone 3',
      sssi: 'SSSI / SAC',
      listed_building: 'Listed building',
      locally_listed: 'Locally listed building',
      none: 'No special designations known'
    },
    constraints: {
      tpo: 'Protected trees (TPO)',
      hedgerows: 'Important hedgerows',
      right_of_way: 'Public right of way',
      contaminated: 'Contaminated land',
      noise: 'Noise (road/rail/industrial)',
      aqma: 'Air Quality Management Area',
      archaeology: 'Archaeological interest',
      heritage_sightlines: 'Heritage sightline constraints',
      unknown: 'Constraints unknown'
    },
    benefits: {
      better_accommodation: 'Better quality accommodation',
      visual_improvement: 'Visual/streetscene improvements',
      energy_efficiency: 'Energy / sustainability benefits',
      more_space: 'Additional internal floorspace',
      better_layout: 'Improved layout / accessibility',
      policy_support: 'Strong policy support'
    },
    risks: {
      overlooking: 'Overlooking / privacy',
      overshadowing: 'Overshadowing / daylight',
      bulk_scale: 'Bulk / scale / massing',
      heritage_harm: 'Heritage impact',
      green_belt_conflict: 'Green Belt conflict',
      parking_highways: 'Parking / highways issues',
      design_non_compliance: 'Design non-compliance',
      drainage_ecology: 'Drainage / ecology issues',
      neighbour_objections: 'Neighbour objections likely'
    }
  };

  form.addEventListener('submit', function (e) {
    e.preventDefault();

    // Basic values
    const clientName = textVal('client_name');
    const siteAddress = textVal('site_address');
    const sitePostcode = textVal('site_postcode');
    const councilName = textVal('council_name');
    const existingUse = textVal('existing_use_class');
    const proposalSummary = textVal('proposal_summary');

    fillText('r_client_name', clientName || '—');
    fillText('r_site_address', siteAddress);
    fillText('r_site_address_2', siteAddress);
    fillText('r_site_postcode', sitePostcode);
    fillText('r_council_name', councilName);
    fillText('r_council_name_2', councilName);
    fillText('r_existing_use_class', existingUse || 'Not specified');
    fillText('r_proposal_summary', proposalSummary || 'Not provided.');

    // Site & proposal type
    const siteTypeText = mapSelect('site_type');
    const proposalTypeText = mapSelect('proposal_type');
    fillText('r_site_type', siteTypeText || 'Not specified');
    fillText('r_proposal_type', proposalTypeText || 'Not specified');

    // Designations & constraints
    const designations = getCheckedValues('designations');
    const constraints = getCheckedValues('constraints');
    buildPills('r_designations', designations, { labels: labelMaps.designations });
    buildPills('r_constraints', constraints, { labels: labelMaps.constraints });

    // Context/impacts
    fillText('r_visibility_public', mapSelect('visibility_public') || 'Not specified');
    fillText('r_privacy_impact', mapSelect('privacy_impact') || 'Not specified');
    fillText('r_daylight_impact', mapSelect('daylight_impact') || 'Not specified');

    // Design & layout
    fillText('r_balcony', mapSelect('balcony_presence') || 'Not specified');
    fillText('r_balcony_screening', mapSelect('balcony_screening') || 'Not specified');
    fillText('r_height', mapSelect('proposal_height') || 'Not specified');
    fillText('r_rear_projection', mapSelect('rear_projection') || 'Not specified');
    fillText('r_materials', mapSelect('materials') || 'Not specified');

    // Policy-level
    fillText('r_has_spd', mapSelect('has_extension_spd') || 'Not specified');
    fillText('r_spd_compliance', mapSelect('spd_compliance') || 'Not specified');
    fillText('r_parking_compliance', mapSelect('parking_compliance') || 'Not specified');
    fillText('r_housing_mix_compliance', mapSelect('housing_mix_compliance') || 'Not specified');
    fillText('r_nppf_sustainable', mapSelect('nppf_sustainable') || 'Not specified');
    fillText('r_nppf_character', mapSelect('nppf_characterscore') || 'Not specified');
    fillText('r_nppf_heritage', mapSelect('nppf_heritage') || 'Not specified');

    // Policy 1
    const policy1Doc = textVal('policy1_doc_title');
    const policy1Authority = textVal('policy1_authority');
    let policy1DocCombined = '';
    if (policy1Doc && policy1Authority) {
      policy1DocCombined = policy1Doc + ' (' + policy1Authority + ')';
    } else {
      policy1DocCombined = policy1Doc || policy1Authority || 'Not specified';
    }
    fillText('r_policy1_doc', policy1DocCombined);
    fillText('r_policy1_ref', textVal('policy1_ref'));
    fillText('r_policy1_title', textVal('policy1_title'));
    fillText('r_policy1_quote', textVal('policy1_quote'));
    fillText('r_policy1_interp', textVal('policy1_interp'));

    // Policy 2
    const policy2Doc = textVal('policy2_doc_title');
    const policy2Authority = textVal('policy2_authority');
    const policy2Any = policy2Doc || policy2Authority || textVal('policy2_ref') || textVal('policy2_quote');
    if (policy2Any) {
      let policy2DocCombined = '';
      if (policy2Doc && policy2Authority) {
        policy2DocCombined = policy2Doc + ' (' + policy2Authority + ')';
      } else {
        policy2DocCombined = policy2Doc || policy2Authority || 'Not specified';
      }
      fillText('r_policy2_doc', policy2DocCombined);
      fillText('r_policy2_ref', textVal('policy2_ref'));
      fillText('r_policy2_title', textVal('policy2_title'));
      fillText('r_policy2_quote', textVal('policy2_quote'));
      fillText('r_policy2_interp', textVal('policy2_interp'));
      document.getElementById('r_policy2_block').style.display = 'block';
    } else {
      document.getElementById('r_policy2_block').style.display = 'none';
    }

    // Technical
    fillText('r_drainage_known', mapSelect('drainage_known') || 'Not specified');
    fillText('r_suds_required', mapSelect('suds_required') || 'Not specified');
    fillText('r_highways_safety', mapSelect('highways_safety') || 'Not specified');
    fillText('r_ecology_risk', mapSelect('ecology_risk') || 'Not specified');
    fillText('r_trees_impact', mapSelect('trees_impact') || 'Not specified');

    // History & precedent
    fillText('r_hist1_ref', textVal('hist1_ref'));
    fillText('r_hist1_desc', textVal('hist1_desc'));
    fillText('r_hist1_decision', mapSelect('hist1_decision') || 'Not specified');
    fillText('r_hist1_date', textVal('hist1_date') ? ' – ' + textVal('hist1_date') : '');
    fillText('r_hist1_officer', textVal('hist1_officer') || 'Not summarised.');
    fillText('r_hist1_relevance', textVal('hist1_relevance') || 'Not explained.');

    fillText('r_prec1_address', textVal('prec1_address'));
    fillText('r_prec1_ref', textVal('prec1_ref'));
    fillText('r_prec1_desc', textVal('prec1_desc'));
    fillText('r_prec1_decision', mapSelect('prec1_decision') || 'Not specified');
    fillText('r_prec1_relevance', textVal('prec1_relevance') || 'Not explained.');

    // Maps
    fillText('r_maps_location_url', textVal('maps_location_url') || 'Not provided');
    fillText('r_maps_streetview_url', textVal('maps_streetview_url') || 'Not provided');

    // Balance
    const likelihoodText = mapSelect('likelihood') || 'Not specified';
    fillText('r_likelihood', likelihoodText);
    fillText('r_likelihood_inline', likelihoodText.toLowerCase());

    const benefits = getCheckedValues('benefits');
    const risks = getCheckedValues('risks');
    buildPills('r_benefits', benefits, { labels: labelMaps.benefits, type: 'benefits' });
    buildPills('r_risks', risks, { labels: labelMaps.risks, type: 'risks' });

    const balanceText = textVal('junior_balance') ||
      'A draft planning balance has not been provided. This section should be completed before issuing to the client.';
    fillText('r_junior_balance', balanceText);

    // Show report view
    inputPanel.style.display = 'none';
    reportPanel.style.display = 'block';
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  backToFormBtn.addEventListener('click', () => {
    reportPanel.style.display = 'none';
    inputPanel.style.display = 'block';
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  printBtn.addEventListener('click', () => {
    window.print();
  });
</script>
</body>
</html>

